<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>IT-Inventory | é›»è…¦è¨­å‚™ç‹€æ…‹ç®¡ç†</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- å¯é¸ï¼šè‹¥å…§ç¶²å…è¨±ï¼Œå¯ä¿ç•™æˆ–ç§»é™¤ Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">

  <style>
    :root {
      --bg: #0f172a;
      --bg-soft: #111827;
      --card-bg: #111827;
      --border-subtle: rgba(148, 163, 253, 0.14);
      --accent: #4f46e5;
      --accent-soft: rgba(79, 70, 229, 0.12);
      --accent-soft-2: rgba(79, 70, 229, 0.06);
      --accent-hover: #6366f1;
      --text: #e5e7eb;
      --text-soft: #9ca3af;
      --danger: #f97373;
      --radius-xl: 16px;
      --radius-md: 10px;
      --shadow-soft: 0 18px 50px rgba(15,23,42,0.55);
      --shadow-soft-sm: 0 10px 26px rgba(15,23,42,0.42);
      --transition-fast: 0.18s ease;
      --font: system-ui, -apple-system, BlinkMacSystemFont, "Inter", -system-ui, sans-serif;
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      padding: 0;
      font-family: var(--font);
      background:
        radial-gradient(circle at top, rgba(79,70,229,0.18), transparent 65%),
        radial-gradient(circle at top right, rgba(14,165,233,0.12), transparent 55%),
        var(--bg);
      color: var(--text);
      min-height: 100vh;
    }

    .page {
      max-width: 1240px;
      margin: 0 auto;
      padding: 24px 18px 32px;
    }

    /* Header / Nav */
    .topbar {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 14px;
      padding: 12px 18px;
      margin-bottom: 18px;
      border-radius: 999px;
      background: radial-gradient(circle at top left, rgba(79,70,229,0.18), transparent),
                  rgba(9, 9, 15, 0.96);
      border: 1px solid rgba(148, 163, 253, 0.18);
      box-shadow: var(--shadow-soft-sm);
      backdrop-filter: blur(18px);
    }
    .brand-title {
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .brand-logo {
      width: 26px;
      height: 26px;
      border-radius: 9px;
      background: radial-gradient(circle at 30% 0, #ffffff, #4f46e5);
      box-shadow: 0 0 14px rgba(79,70,229,0.85);
    }
    .brand-text-main {
      font-weight: 600;
      letter-spacing: 0.06em;
      font-size: 14px;
      text-transform: uppercase;
      color: #c7d2fe;
    }
    .brand-text-sub {
      font-size: 11px;
      color: var(--text-soft);
    }
    .top-meta {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      align-items: center;
      justify-content: flex-end;
      font-size: 11px;
      color: var(--text-soft);
    }
    .pill {
      padding: 3px 9px;
      border-radius: 999px;
      border: 1px solid rgba(148,163,253,0.22);
      background: rgba(15,23,42,0.9);
      display: flex;
      align-items: center;
      gap: 5px;
    }
    .pill-dot {
      width: 7px;
      height: 7px;
      border-radius: 999px;
      background: #22c55e;
      box-shadow: 0 0 8px #22c55e;
    }
    .pill-label {
      color: #a5b4fc;
    }
    .pill-strong {
      color: #e5e7eb;
      font-weight: 500;
    }

    /* Main layout */
    .layout {
      display: grid;
      grid-template-columns: minmax(260px, 320px) minmax(0, 1fr);
      gap: 18px;
      align-items: flex-start;
    }

    .card {
      background: radial-gradient(circle at top left, rgba(79,70,229,0.12), transparent),
                  var(--card-bg);
      border-radius: var(--radius-xl);
      border: 1px solid var(--border-subtle);
      padding: 14px 14px 12px;
      box-shadow: var(--shadow-soft);
      backdrop-filter: blur(18px);
    }

    .card h2 {
      margin: 0 0 2px;
      font-size: 15px;
      font-weight: 500;
      color: #e5e7ff;
    }

    .card-subtitle {
      font-size: 11px;
      color: var(--text-soft);
      margin-bottom: 8px;
    }

    label {
      display: block;
      font-size: 10px;
      margin: 6px 0 3px;
      color: var(--text-soft);
      letter-spacing: 0.02em;
      text-transform: uppercase;
    }

    input, select, textarea {
      font-size: 12px;
      padding: 7px 8px;
      width: 100%;
      border-radius: 8px;
      border: 1px solid rgba(75,85,99,0.9);
      background: rgba(9,9,15,0.96);
      color: var(--text);
      outline: none;
      transition: border-color var(--transition-fast), box-shadow var(--transition-fast), background var(--transition-fast), transform var(--transition-fast);
    }
    input::placeholder,
    textarea::placeholder {
      color: #6b7280;
    }
    input:focus, select:focus, textarea:focus {
      border-color: var(--accent);
      box-shadow: 0 0 0 1px rgba(79,70,229,0.35);
      background: #020817;
      transform: translateY(-1px);
    }
    textarea {
      resize: vertical;
      min-height: 52px;
    }

    .row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 8px;
    }

    .btn-row {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 10px;
    }

    button {
      cursor: pointer;
      border-radius: 999px;
      padding: 7px 14px;
      font-size: 11px;
      border: none;
      background: var(--accent-soft-2);
      color: var(--text);
      display: inline-flex;
      align-items: center;
      gap: 6px;
      transition: all var(--transition-fast);
      box-shadow: 0 4px 10px rgba(15,23,42,0.4);
    }
    button span.icon {
      font-size: 13px;
      line-height: 1;
    }
    button.primary {
      background: linear-gradient(to right, var(--accent), var(--accent-hover));
      color: #f9fafb;
      font-weight: 500;
      box-shadow: 0 8px 20px rgba(79,70,229,0.6);
    }
    button.primary:hover {
      transform: translateY(-1px);
      box-shadow: 0 10px 26px rgba(79,70,229,0.8);
    }
    button:hover {
      background: var(--accent-soft);
      transform: translateY(-1px);
      box-shadow: 0 6px 14px rgba(15,23,42,0.7);
    }
    button.danger {
      background: rgba(127,29,29,0.12);
      color: var(--danger);
      box-shadow: 0 4px 12px rgba(127,29,29,0.35);
      border: 1px solid rgba(248,113,113,0.28);
    }
    button.danger:hover {
      background: rgba(127,29,29,0.22);
      transform: translateY(-1px);
    }

    /* Filters + table */
    .filters {
      margin: 2px 0 8px;
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      align-items: center;
    }
    .filters input, .filters select {
      width: auto;
      min-width: 130px;
      padding-right: 26px;
      background: rgba(9,9,15,0.98);
    }
    .filters-label {
      font-size: 10px;
      color: var(--text-soft);
      margin-right: 2px;
    }

    .table-wrap {
      margin-top: 4px;
      border-radius: 14px;
      border: 1px solid rgba(148,163,253,0.16);
      overflow: hidden;
      background: radial-gradient(circle at top, rgba(15,23,42,1), rgba(9,9,15,1));
      box-shadow: var(--shadow-soft-sm);
    }

    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 11px;
    }

    thead {
      background: linear-gradient(to right, rgba(15,23,42,0.98), rgba(17,24,39,0.98));
      backdrop-filter: blur(12px);
    }

    th, td {
      padding: 7px 8px;
      border-bottom: 1px solid rgba(31,41,55,0.9);
      color: #9ca3af;
      text-align: left;
      white-space: nowrap;
    }

    th {
      font-size: 10px;
      font-weight: 500;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: #6b7280;
      position: sticky;
      top: 0;
      z-index: 5;
      cursor: pointer;
      user-select: none;
    }

    th[data-sort]:hover {
      color: #a5b4fc;
      background: rgba(15,23,42,0.96);
    }

    tbody tr {
      transition: background var(--transition-fast), transform var(--transition-fast), box-shadow var(--transition-fast);
    }

    tbody tr:nth-child(even) {
      background: rgba(9,9,15,0.98);
    }
    tbody tr:nth-child(odd) {
      background: rgba(6,8,16,0.98);
    }

    tbody tr:hover {
      background: rgba(17,24,39,1);
      transform: translateY(-1px);
      box-shadow: 0 8px 18px rgba(15,23,42,0.85);
    }

    td {
      color: #e5e7eb;
      max-width: 260px;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .status-ok,
    .status-repair,
    .status-retired,
    .status-loan {
      font-size: 10px;
      font-weight: 500;
      padding: 3px 8px;
      border-radius: 999px;
      display: inline-flex;
      align-items: center;
      gap: 4px;
    }
    .status-ok {
      color: #bbf7d0;
      background: rgba(22,163,74,0.16);
      border: 1px solid rgba(34,197,94,0.55);
    }
    .status-repair {
      color: #fed7aa;
      background: rgba(234,179,8,0.12);
      border: 1px solid rgba(249,115,22,0.55);
    }
    .status-retired {
      color: #9ca3af;
      background: rgba(75,85,99,0.18);
      border: 1px solid rgba(75,85,99,0.6);
    }
    .status-loan {
      color: #bfdbfe;
      background: rgba(37,99,235,0.16);
      border: 1px solid rgba(59,130,246,0.6);
    }

    .note {
      font-size: 10px;
      color: #9ca3af;
      white-space: nowrap;
    }

    .actions {
      display: flex;
      gap: 4px;
    }
    .actions button {
      padding: 3px 8px;
      font-size: 9px;
      box-shadow: none;
      background: rgba(15,23,42,0.98);
      border-radius: 999px;
      border: 1px solid rgba(75,85,99,0.9);
    }
    .actions button:hover {
      background: rgba(79,70,229,0.16);
      border-color: var(--accent);
      transform: translateY(-1px);
      box-shadow: 0 4px 10px rgba(15,23,42,0.85);
    }

    @media (max-width: 860px) {
      .page { padding: 18px 12px 26px; }
      .topbar {
        flex-direction: column;
        align-items: flex-start;
        border-radius: 18px;
      }
      .layout {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>

<div class="page">
  <!-- Top bar -->
  <div class="topbar">
    <div class="brand-title">
      <div class="brand-logo"></div>
      <div>
        <div class="brand-text-main">IT INVENTORY CONSOLE</div>
        <div class="brand-text-sub">Computer Assets Â· Status Â· Ownership Â· Lifecycle</div>
      </div>
    </div>
    <div class="top-meta">
      <div class="pill">
        <div class="pill-dot"></div>
        <span class="pill-label">Environment</span>
        <span class="pill-strong">Internal Only</span>
      </div>
      <div class="pill">
        <span class="pill-label">Last Sync</span>
        <span class="pill-strong" id="lastSync">â€”</span>
      </div>
      <div class="pill">
        <span class="pill-label">Storage</span>
        <span class="pill-strong">Local Browser (Demo)</span>
      </div>
    </div>
  </div>

  <div class="layout">
    <!-- Left: Form -->
    <div class="card">
      <h2 id="formTitle">æ–°å¢ / ç·¨è¼¯é›»è…¦è³‡æ–™</h2>
      <div class="card-subtitle">ä»¥ã€Œè³‡ç”¢ç·¨è™Ÿã€ä½œç‚ºå”¯ä¸€éµï¼Œå„²å­˜æ™‚è‹¥å·²å­˜åœ¨å‰‡è‡ªå‹•æ›´æ–°è©²ç­†ã€‚</div>

      <form id="pcForm">
        <label>è³‡ç”¢ç·¨è™Ÿï¼ˆå¿…å¡«ï¼Œå”¯ä¸€ï¼‰
          <input type="text" id="asset_id" required>
        </label>

        <label>Hostname
          <input type="text" id="hostname">
        </label>

        <div class="row">
          <div>
            <label>ä½¿ç”¨è€…
              <input type="text" id="user">
            </label>
          </div>
          <div>
            <label>éƒ¨é–€
              <input type="text" id="department" placeholder="ä¾‹å¦‚ï¼šè¡Œæ”¿ / ç”Ÿç”¢ / å“ä¿ / ç ”ç™¼">
            </label>
          </div>
        </div>

        <div class="row">
          <div>
            <label>ä½ç½®
              <input type="text" id="location" placeholder="ä¾‹å¦‚ï¼šè¾¦å…¬å®¤A / å€‰åº« / æ©Ÿæˆ¿">
            </label>
          </div>
          <div>
            <label>ç‹€æ…‹
              <select id="status">
                <option value="æ­£å¸¸">æ­£å¸¸</option>
                <option value="ç¶­ä¿®ä¸­">ç¶­ä¿®ä¸­</option>
                <option value="å ±å»¢">å ±å»¢</option>
                <option value="å€Ÿå‡ºä¸­">å€Ÿå‡ºä¸­</option>
              </select>
            </label>
          </div>
        </div>

        <label>è¦æ ¼ï¼ˆé¸å¡«ï¼‰
          <input type="text" id="spec" placeholder="ä¾‹å¦‚ï¼ši5 / 16GB / 512GB SSD">
        </label>

        <div class="row">
          <div>
            <label>ä½œæ¥­ç³»çµ±
              <input type="text" id="os" placeholder="ä¾‹å¦‚ï¼šWindows 10 Pro">
            </label>
          </div>
          <div>
            <label>ç¶­è­·äººå“¡
              <input type="text" id="owner" placeholder="ä¾‹å¦‚ï¼šIT-Allen">
            </label>
          </div>
        </div>

        <label>å‚™è¨»
          <textarea id="note" placeholder="ä¾‹å¦‚ï¼šé¢¨æ‰‡ç•°éŸ³ / å·²é€ä¿® / é è¨ˆå ±å»¢æ™‚é–“"></textarea>
        </label>

        <div class="btn-row">
          <button type="submit" class="primary">
            <span class="icon">ğŸ’¾</span>
            <span>å„²å­˜ï¼ˆæ–°å¢ / æ›´æ–°ï¼‰</span>
          </button>
          <button type="button" onclick="clearForm()">
            <span class="icon">ğŸ§¹</span>
            <span>æ¸…ç©ºè¡¨å–®</span>
          </button>
        </div>
        <div class="btn-row">
          <button type="button" class="danger" onclick="resetToDefault()">
            <span class="icon">â†º</span>
            <span>é‡ç½®ç‚ºç¯„ä¾‹è³‡æ–™ï¼ˆåƒ…æœ¬æ©Ÿï¼‰</span>
          </button>
        </div>
      </form>
    </div>

    <!-- Right: List -->
    <div class="card">
      <h2>è¨­å‚™æ¸…å–® / æŸ¥è©¢</h2>
      <div class="card-subtitle">å¯ä¾ç‹€æ…‹ã€éƒ¨é–€èˆ‡é—œéµå­—å¿«é€Ÿç¯©é¸ï¼Œé»æ¬„ä½åç¨±å¯æ’åºã€‚</div>

      <div class="filters">
        <span class="filters-label">ç¯©é¸ï¼š</span>
        <input type="text" id="searchInput" placeholder="æœå°‹ è³‡ç”¢ç·¨è™Ÿ / ä½¿ç”¨è€… / Hostname">
        <select id="statusFilter">
          <option value="">ç‹€æ…‹ï¼šå…¨éƒ¨</option>
          <option value="æ­£å¸¸">æ­£å¸¸</option>
          <option value="ç¶­ä¿®ä¸­">ç¶­ä¿®ä¸­</option>
          <option value="å ±å»¢">å ±å»¢</option>
          <option value="å€Ÿå‡ºä¸­">å€Ÿå‡ºä¸­</option>
        </select>
        <input type="text" id="deptFilter" placeholder="éƒ¨é–€ï¼šå…¨éƒ¨">
      </div>

      <div class="table-wrap">
        <table id="pcTable">
          <thead>
            <tr>
              <th data-sort="asset_id">è³‡ç”¢ç·¨è™Ÿ</th>
              <th data-sort="hostname">Hostname</th>
              <th data-sort="user">ä½¿ç”¨è€…</th>
              <th data-sort="department">éƒ¨é–€</th>
              <th data-sort="location">ä½ç½®</th>
              <th data-sort="status">ç‹€æ…‹</th>
              <th>å‚™è¨»</th>
              <th>æ“ä½œ</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </div>
  </div>
</div>

<script>
  const STORAGE_KEY = "it_inventory_data_v1";

  const defaultComputers = [
    {
      asset_id: "PC-001",
      hostname: "OFFICE-001",
      user: "ç‹å°æ˜",
      department: "è¡Œæ”¿",
      location: "è¾¦å…¬å®¤ A",
      type: "Desktop",
      spec: "i5 / 16GB / 512GB SSD",
      os: "Windows 10 Pro",
      status: "æ­£å¸¸",
      last_update: "2025-11-01",
      owner: "IT-Allen",
      note: ""
    },
    {
      asset_id: "PC-012",
      hostname: "QA-LAB-01",
      user: "å¼µå“å¦¤",
      department: "å“ä¿",
      location: "å“ä¿å¯¦é©—å®¤",
      type: "Desktop",
      spec: "i7 / 32GB / 1TB SSD",
      os: "Windows 11 Pro",
      status: "ç¶­ä¿®ä¸­",
      last_update: "2025-11-08",
      owner: "IT-Allen",
      note: "ç„¡æ³•é–‹æ©Ÿï¼Œé€ä¿®ä¸­"
    },
    {
      asset_id: "NB-005",
      hostname: "SALES-NB-01",
      user: "æå…ˆç”Ÿ",
      department: "ç”Ÿç”¢",
      location: "å¤–å‡ºæ”œå¸¶",
      type: "Laptop",
      spec: "Ryzen 5 / 16GB / 512GB",
      os: "Windows 11 Pro",
      status: "å€Ÿå‡ºä¸­",
      last_update: "2025-11-03",
      owner: "IT-Allen",
      note: "é è¨ˆ 11/15 æ­¸é‚„"
    },
    {
      asset_id: "PC-020",
      hostname: "OLD-SERVER-01",
      user: "-",
      department: "ç ”ç™¼",
      location: "æ©Ÿæˆ¿",
      type: "Desktop",
      spec: "å¤è€æ©Ÿç¨®",
      os: "Windows 7",
      status: "å ±å»¢",
      last_update: "2025-10-20",
      owner: "IT-Allen",
      note: "åƒ…ä¿ç•™ç¡¬ç¢Ÿå¾…éŠ·æ¯€"
    }
  ];

  let computers = [];
  let currentSortKey = "asset_id";
  let currentSortAsc = true;

  const lastSyncEl = document.getElementById("lastSync");
  const tbody = document.querySelector("#pcTable tbody");
  const searchInput = document.getElementById("searchInput");
  const statusFilter = document.getElementById("statusFilter");
  const deptFilter = document.getElementById("deptFilter");
  const formTitle = document.getElementById("formTitle");

  const form = document.getElementById("pcForm");
  const f_asset_id = document.getElementById("asset_id");
  const f_hostname = document.getElementById("hostname");
  const f_user = document.getElementById("user");
  const f_department = document.getElementById("department");
  const f_location = document.getElementById("location");
  const f_status = document.getElementById("status");
  const f_spec = document.getElementById("spec");
  const f_os = document.getElementById("os");
  const f_owner = document.getElementById("owner");
  const f_note = document.getElementById("note");

  function loadData() {
    const saved = localStorage.getItem(STORAGE_KEY);
    if (saved) {
      try {
        const parsed = JSON.parse(saved);
        if (Array.isArray(parsed)) return parsed;
      } catch (e) {
        console.warn("localStorage è³‡æ–™è§£æå¤±æ•—ï¼Œä½¿ç”¨é è¨­è³‡æ–™");
      }
    }
    return [...defaultComputers];
  }

  function saveData() {
    const today = new Date().toISOString().slice(0, 10);
    computers = computers.map(c => ({
      ...c,
      last_update: c.last_update || today
    }));
    localStorage.setItem(STORAGE_KEY, JSON.stringify(computers));
    updateLastSync();
    renderTable();
  }

  function updateLastSync() {
    if (!computers.length) {
      lastSyncEl.textContent = "ç„¡è³‡æ–™";
      return;
    }
    const latest = computers.reduce(
      (max, c) => (c.last_update && c.last_update > max ? c.last_update : max),
      "0000-00-00"
    );
    lastSyncEl.textContent = latest || "æœªè¨­å®š";
  }

  function renderTable() {
    const keyword = searchInput.value.trim().toLowerCase();
    const fStatus = statusFilter.value;
    const fDept = deptFilter.value.trim();

    let data = [...computers];

    data = data.filter(c => {
      if (fStatus && c.status !== fStatus) return false;
      if (fDept && c.department !== fDept) return false;
      if (keyword) {
        const text = (
          (c.asset_id || "") +
          (c.hostname || "") +
          (c.user || "") +
          (c.department || "")
        ).toLowerCase();
        if (!text.includes(keyword)) return false;
      }
      return true;
    });

    data.sort((a, b) => {
      const x = (a[currentSortKey] || "").toString();
      const y = (b[currentSortKey] || "").toString();
      if (x === y) return 0;
      return currentSortAsc
        ? x.localeCompare(y, "zh-Hant")
        : y.localeCompare(x, "zh-Hant");
    });

    tbody.innerHTML = "";
    data.forEach(c => {
      const tr = document.createElement("tr");

      const statusClass =
        c.status === "æ­£å¸¸" ? "status-ok" :
        c.status === "ç¶­ä¿®ä¸­" ? "status-repair" :
        c.status === "å ±å»¢" ? "status-retired" :
        c.status === "å€Ÿå‡ºä¸­" ? "status-loan" : "";

      tr.innerHTML = `
        <td>${c.asset_id || ""}</td>
        <td>${c.hostname || ""}</td>
        <td>${c.user || ""}</td>
        <td>${c.department || ""}</td>
        <td>${c.location || ""}</td>
        <td><span class="${statusClass}">${c.status || ""}</span></td>
        <td class="note">${c.note || ""}</td>
        <td class="actions">
          <button type="button" onclick="editComputer('${c.asset_id || ""}')">ç·¨è¼¯</button>
          <button type="button" onclick="deleteComputer('${c.asset_id || ""}')">åˆªé™¤</button>
        </td>
      `;
      tbody.appendChild(tr);
    });
  }

  document.querySelectorAll("th[data-sort]").forEach(th => {
    th.addEventListener("click", () => {
      const key = th.getAttribute("data-sort");
      if (currentSortKey === key) {
        currentSortAsc = !currentSortAsc;
      } else {
        currentSortKey = key;
        currentSortAsc = true;
      }
      renderTable();
    });
  });

  form.addEventListener("submit", function (e) {
    e.preventDefault();

    const asset_id = f_asset_id.value.trim();
    if (!asset_id) {
      alert("è«‹å¡«å¯«è³‡ç”¢ç·¨è™Ÿï¼ˆå¿…å¡«ï¼Œä¸”ä¸å¯é‡è¤‡ï¼‰");
      return;
    }

    const existingIndex = computers.findIndex(c => c.asset_id === asset_id);
    const today = new Date().toISOString().slice(0, 10);

    const newData = {
      asset_id,
      hostname: f_hostname.value.trim(),
      user: f_user.value.trim(),
      department: f_department.value.trim(),
      location: f_location.value.trim(),
      status: f_status.value,
      spec: f_spec.value.trim(),
      os: f_os.value.trim(),
      owner: f_owner.value.trim(),
      note: f_note.value.trim(),
      last_update: today
    };

    if (existingIndex >= 0) {
      computers[existingIndex] = newData;
    } else {
      computers.push(newData);
    }

    saveData();
    clearForm();
  });

  function clearForm() {
    form.reset();
    f_status.value = "æ­£å¸¸";
    formTitle.textContent = "æ–°å¢ / ç·¨è¼¯é›»è…¦è³‡æ–™";
  }

  function editComputer(asset_id) {
    const c = computers.find(x => x.asset_id === asset_id);
    if (!c) return;
    f_asset_id.value = c.asset_id || "";
    f_hostname.value = c.hostname || "";
    f_user.value = c.user || "";
    f_department.value = c.department || "";
    f_location.value = c.location || "";
    f_status.value = c.status || "æ­£å¸¸";
    f_spec.value = c.spec || "";
    f_os.value = c.os || "";
    f_owner.value = c.owner || "";
    f_note.value = c.note || "";
    formTitle.textContent = `ç·¨è¼¯ï¼š${c.asset_id}`;
    f_asset_id.focus();
  }

  function deleteComputer(asset_id) {
    if (!asset_id) return;
    if (!confirm(`ç¢ºå®šè¦åˆªé™¤è³‡ç”¢ç·¨è™Ÿ ${asset_id} å—ï¼Ÿ`)) return;
    computers = computers.filter(c => c.asset_id !== asset_id);
    saveData();
    if (f_asset_id.value === asset_id) clearForm();
  }

  function resetToDefault() {
    if (!confirm("æ­¤å‹•ä½œåƒ…å½±éŸ¿æœ¬æ©Ÿç€è¦½å™¨ï¼Œå°‡æ¸…é™¤ç›®å‰è³‡æ–™ä¸¦é‚„åŸç‚ºç¯„ä¾‹ï¼Œç¢ºå®šï¼Ÿ")) return;
    localStorage.removeItem(STORAGE_KEY);
    computers = [...defaultComputers];
    updateLastSync();
    renderTable();
    clearForm();
  }

  window.editComputer = editComputer;
  window.deleteComputer = deleteComputer;
  window.resetToDefault = resetToDefault;
  window.clearForm = clearForm;

  (function init() {
    computers = loadData();
    updateLastSync();
    renderTable();
  })();
</script>

</body>
</html>
